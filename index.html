<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mixed Integer Optimization for Metabolism"><meta name=author content="Pablo Rodriguez-Mier"><link href=https://metexplore.github.io/miom/ rel=canonical><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.2.2, mkdocs-material-7.2.4"><title>MIOM</title><link rel=stylesheet href=assets/stylesheets/main.f7f47774.min.css><link rel=stylesheet href=assets/stylesheets/palette.3f5d1f46.min.css><meta name=theme-color content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=assets/_mkdocstrings.css><link rel=stylesheet href=stylesheets/extra.css><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5SV6WE1KMZ"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-5SV6WE1KMZ",{page_path:t.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-5SV6WE1KMZ"></script><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css></head> <body dir=ltr data-md-color-scheme data-md-color-primary=#2e5c87 data-md-color-accent> <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=. title=MIOM class="md-header__button md-logo" aria-label=MIOM data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MIOM </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Home </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://www.github.com/metexplore/miom title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> miom </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=. title=MIOM class="md-nav__button md-logo" aria-label=MIOM data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> MIOM </label> <div class=md-nav__source> <a href=https://www.github.com/metexplore/miom title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> miom </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Home <span class="md-nav__icon md-icon"></span> </label> <a href=. class="md-nav__link md-nav__link--active"> Home </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#minimal-install class=md-nav__link> Minimal install </a> </li> <li class=md-nav__item> <a href=#full-install class=md-nav__link> Full install </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> Quick start </a> <nav class=md-nav aria-label="Quick start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#importing-a-genome-scale-metabolic-network-gems class=md-nav__link> Importing a Genome-Scale Metabolic Network (GEMs) </a> </li> <li class=md-nav__item> <a href=#managing-metabolic-networks class=md-nav__link> Managing Metabolic Networks </a> </li> <li class=md-nav__item> <a href=#constraint-based-optimization-problems class=md-nav__link> Constraint-based optimization problems </a> </li> <li class=md-nav__item> <a href=#mixed-integer-optimization class=md-nav__link> Mixed Integer Optimization </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advantages class=md-nav__link> Advantages </a> </li> <li class=md-nav__item> <a href=#documentation class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=#how-to-cite class=md-nav__link> How to cite </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Examples <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Examples data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=examples/fastcore/ class=md-nav__link> Exact Fastcore (MIP) </a> </li> <li class=md-nav__item> <a href=examples/fba/ class=md-nav__link> Flux Balance Analysis (LP) </a> </li> <li class=md-nav__item> <a href=examples/imat/ class=md-nav__link> iMAT: Integrative Metabolic Analysis Tool (MIP) </a> </li> <li class=md-nav__item> <a href=examples/sparse_fba/ class=md-nav__link> Sparse FBA (MIP) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=References data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=references/mio/ class=md-nav__link> mio.py </a> </li> <li class=md-nav__item> <a href=references/miom/ class=md-nav__link> miom.py </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#minimal-install class=md-nav__link> Minimal install </a> </li> <li class=md-nav__item> <a href=#full-install class=md-nav__link> Full install </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> Quick start </a> <nav class=md-nav aria-label="Quick start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#importing-a-genome-scale-metabolic-network-gems class=md-nav__link> Importing a Genome-Scale Metabolic Network (GEMs) </a> </li> <li class=md-nav__item> <a href=#managing-metabolic-networks class=md-nav__link> Managing Metabolic Networks </a> </li> <li class=md-nav__item> <a href=#constraint-based-optimization-problems class=md-nav__link> Constraint-based optimization problems </a> </li> <li class=md-nav__item> <a href=#mixed-integer-optimization class=md-nav__link> Mixed Integer Optimization </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advantages class=md-nav__link> Advantages </a> </li> <li class=md-nav__item> <a href=#documentation class=md-nav__link> Documentation </a> </li> <li class=md-nav__item> <a href=#how-to-cite class=md-nav__link> How to cite </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <p><a href=https://metexplore.github.io/miom><img src=assets/img/miom_v1_fit.png alt=MIOM title="MIOM: Mixed Integer Optimization for Metabolism"></a></p> <p><a href="https://colab.research.google.com/drive/1JAOEHLlRCW8GziIpBqkFwJL2ha3OEOWJ?usp=sharing"><img alt="Try It Online" src=https://colab.research.google.com/assets/colab-badge.svg></a> <a href=https://pypi.org/project/miom/ ><img alt=PyPI src="https://img.shields.io/pypi/v/miom?label=PyPI"></a> <img alt=Tests src=https://github.com/metexplore/miom/actions/workflows/unit-tests.yml/badge.svg> <a href=https://pepy.tech/project/miom><img alt=Downloads src=https://pepy.tech/badge/miom></a></p> <h1 id=introduction>Introduction</h1> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This library is functional but still in a very early stage. API is still not stable and might be changed in future versions.</p> </div> <p><strong>MIOM</strong> (Mixed Integer Optimization for Metabolism) is a python library for creating and solving complex optimization problems using genome-scale metabolic networks, in just a few lines. </p> <p>MIOM offers a high-level API that leverages the power of modern Mixed Integer Optimization (MIO) solvers to easily define steady-state metabolic optimization problems, from simple Flux Balance Analysis (FBA) simulations, to more complex problems, such as sparse FBA or context-specific reconstruction algorithms, and solve them the <strong>required level of optimality</strong>. It supports many free and commercial solvers thanks to the integration with the <a href=https://picos-api.gitlab.io/picos/ >PICOS</a> and the <a href=https://www.python-mip.com/ >Python-MIP</a>. It is also compatible and complementary to <a href=https://opencobra.github.io/cobrapy/ >cobrapy</a>.</p> <p>Here is a simple example of the differences of implementing from scratch a simple Flux Balance Analysis (FBA), which is typically implemented as a Linear Program (LP) problem, and the Sparse FBA problem which is an Integer Programmming (IP) problem that solves the same FBA problem but minimizing the number of active reactions:</p> <div class=tabbed-set data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>FBA (LP)</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>miom</span>
<span class=n>model</span> <span class=o>=</span> <span class=p>(</span><span class=n>miom</span>
         <span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;@BiGG/Recon3D.miom&#39;</span><span class=p>)</span>
         <span class=o>.</span><span class=n>steady_state</span><span class=p>()</span>
         <span class=o>.</span><span class=n>set_rxn_objective</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>)</span>
         <span class=o>.</span><span class=n>solve</span><span class=p>(</span><span class=n>verbosity</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Optimal flux:&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>get_fluxes</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Number of active reactions:&quot;</span><span class=p>,</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>get_fluxes</span><span class=p>())</span> <span class=o>&gt;</span> <span class=mf>1e-8</span><span class=p>))</span>
</code></pre></div> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Sparse FBA (MIP)</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>miom</span>
<span class=n>model</span> <span class=o>=</span> <span class=p>(</span><span class=n>miom</span>
         <span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;@BiGG/Recon3D.miom&#39;</span><span class=p>)</span>
         <span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>opt_tol</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> <span class=n>verbosity</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
         <span class=o>.</span><span class=n>steady_state</span><span class=p>()</span>
         <span class=o>.</span><span class=n>set_rxn_objective</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>)</span>
         <span class=o>.</span><span class=n>solve</span><span class=p>()</span>
         <span class=o>.</span><span class=n>set_fluxes_for</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>)</span>
         <span class=o>.</span><span class=n>subset_selection</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
         <span class=o>.</span><span class=n>solve</span><span class=p>())</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Optimal flux:&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>get_fluxes</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Number of active reactions:&quot;</span><span class=p>,</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>get_fluxes</span><span class=p>())</span> <span class=o>&gt;</span> <span class=mf>1e-8</span><span class=p>))</span>
</code></pre></div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>To better understand the meaning of each step, please read the documentation of the <a href=https://metexplore.github.io/miom/references/miom/#miom.miom.BaseModel>BaseModel class</a>, and the complete example in <a href=https://metexplore.github.io/miom/examples/sparse_fba>examples/sparse_fba.py</a>. </p> </div> <h2 id=installation>Installation</h2> <h3 id=minimal-install>Minimal install</h3> <p>By default, MIOM comes with support for COIN-OR CBC solver and GLPK using the swiglpk wrapper. To install MIOM with minimal dependencies, run:</p> <div class=highlight><pre><span></span><code>pip install miom
</code></pre></div> <h3 id=full-install>Full install</h3> <p>The full install option of <code>miom</code> comes also with the interfaces for <a href=https://www.gurobi.com/downloads>Gurobi</a> and <a href=https://www.mosek.com/downloads/ >Mosek</a>. Also, in order to be able to import metabolic networks in different formats (SBML, Matlab, YAML, etc), you need to install the additional <code>cobra</code> and <code>scipy</code> packages:</p> <div class=highlight><pre><span></span><code>pip install miom[all] cobra scipy
</code></pre></div> <p>CPLEX is also supported, but requires a valid license. To install MIOM with CPLEX support, follow the instructions on the <a href="https://www.ibm.com/docs/en/icos/12.8.0.0?topic=cplex-setting-up-python-api">CPLEX page</a> to install your current version of cplex in your python environment.</p> <h2 id=quick-start>Quick start</h2> <h3 id=importing-a-genome-scale-metabolic-network-gems>Importing a Genome-Scale Metabolic Network (GEMs)</h3> <p>First step is to import a Genome-Scale Metabolic Network. The method <code>load_gem()</code> can be used to import a network from a local file or a URL. This method requires the <a href=https://cobrapy.readthedocs.io/en/latest/ >cobrapy</a> and <a href=https://www.scipy.org/ >scipy</a> packages to import networks in the SBML, YAML, JSON, and Matlab formats (see <a href=#full-install>Full install</a>). Here is an example of importing the <a href=http://bigg.ucsd.edu/models/Recon3D>BiGG Recon3D</a> network:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>miom</span>
<span class=n>network</span> <span class=o>=</span> <span class=n>miom</span><span class=o>.</span><span class=n>load_gem</span><span class=p>(</span><span class=s1>&#39;https://github.com/SBRG/bigg_models_data/raw/master/models/Recon3D.mat&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Number of reactions in the network:&quot;</span><span class=p>,</span> <span class=n>network</span><span class=o>.</span><span class=n>num_reactions</span><span class=p>)</span>
</code></pre></div> <p>By default, MIOM uses its own format (.miom) which is a lightweight, compressed and portable format based on numpy structured arrays to store only the essential information required to perform common tasks. To improve reproducibility of experiments, a repository of already converted models is available at <a href=https://github.com/pablormier/miom-gems/ >pablormier/miom-gems</a>. Any model from this repository can be imported using shorthand links in the following forma: <code>@relative/path/to/model</code>. For example, in order to import the <a href=https://github.com/pablormier/miom-gems/tree/main/gems/SysBioChalmers/Human-Gem/v1.9.0>Human-GEM v1.9.0</a>, you only need to run:</p> <div class=highlight><pre><span></span><code><span class=n>network</span> <span class=o>=</span> <span class=n>miom</span><span class=o>.</span><span class=n>load_gem</span><span class=p>(</span><span class=s1>&#39;@SysBioChalmers/Human-Gem/v1.9.0&#39;</span><span class=p>)</span>
</code></pre></div> <p>This is a very convenient way of importing models and sharing <strong>reproducible experiments</strong>, making sure that other users are going to test the same models.</p> <h3 id=managing-metabolic-networks>Managing Metabolic Networks</h3> <p>MIOM is not intended to provide functions for creating and managing metabolic networks, since there are already other libraries for this purpose (e.g. <a href=https://opencobra.github.io/cobrapy/ >cobrapy</a>). If you rely on <code>cobrapy</code> for model manipulation, you can still use MIOM for the optimization after you prepare your metabolic network, as MIOM is nicely integrated with COBRA:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>cobra.test</span> <span class=kn>import</span> <span class=n>create_test_model</span>
<span class=n>network</span> <span class=o>=</span> <span class=n>create_test_model</span><span class=p>(</span><span class=s2>&quot;textbook&quot;</span><span class=p>)</span>
<span class=n>medium</span> <span class=o>=</span> <span class=n>network</span><span class=o>.</span><span class=n>medium</span>
<span class=n>medium</span><span class=p>[</span><span class=s2>&quot;EX_o2_e&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=mf>0.0</span>
<span class=n>network</span><span class=o>.</span><span class=n>medium</span> <span class=o>=</span> <span class=n>medium</span>

<span class=c1># Use MIOM for optimization</span>
<span class=n>flux</span> <span class=o>=</span> <span class=p>(</span><span class=n>miom</span>
        <span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>miom</span><span class=o>.</span><span class=n>mio</span><span class=o>.</span><span class=n>cobra_to_miom</span><span class=p>(</span><span class=n>network</span><span class=p>))</span>
        <span class=o>.</span><span class=n>steady_state</span><span class=p>()</span>
        <span class=o>.</span><span class=n>set_rxn_objective</span><span class=p>(</span><span class=s1>&#39;Biomass_Ecoli_core&#39;</span><span class=p>)</span>
        <span class=o>.</span><span class=n>solve</span><span class=p>()</span>
        <span class=o>.</span><span class=n>get_fluxes</span><span class=p>(</span><span class=s1>&#39;Biomass_Ecoli_core&#39;</span><span class=p>))</span>
</code></pre></div> <p>Metabolic Networks in MIOM are represented by a <code>miom.mio.MiomNetwork</code> class. This class encodes the network into three matrices: <code>R</code> (reactions), <code>S</code> (stoichiometry), and <code>M</code> (metabolites). The <code>R</code> matrix is a numpy structured array that contains the list of the reactions defined in the network, including the reaction ID, the reaction name, the reaction bounds, the subsystem and the Gene-Protein-Rules:</p> <div class=highlight><pre><span></span><code><span class=o>&gt;&gt;&gt;</span> <span class=n>miom</span><span class=o>.</span><span class=n>load_gem</span><span class=p>(</span><span class=s1>&#39;@BiGG/Recon3D.miom&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>R</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span>

<span class=n>array</span><span class=p>([(</span><span class=s1>&#39;10FTHF5GLUtl&#39;</span><span class=p>,</span> <span class=s1>&#39;5-Glutamyl-10Fthf Transport, Lysosomal&#39;</span><span class=p>,</span> <span class=mf>0.</span><span class=p>,</span> <span class=mf>1000.</span><span class=p>,</span> <span class=s1>&#39;Transport, lysosomal&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>),</span>
       <span class=p>(</span><span class=s1>&#39;10FTHF5GLUtm&#39;</span><span class=p>,</span> <span class=s1>&#39;5-Glutamyl-10Fthf Transport, Mitochondrial&#39;</span><span class=p>,</span> <span class=mf>0.</span><span class=p>,</span> <span class=mf>1000.</span><span class=p>,</span> <span class=s1>&#39;Transport, mitochondrial&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>),</span>
       <span class=p>(</span><span class=s1>&#39;10FTHF6GLUtl&#39;</span><span class=p>,</span> <span class=s1>&#39;6-Glutamyl-10Fthf Transport, Lysosomal&#39;</span><span class=p>,</span> <span class=mf>0.</span><span class=p>,</span> <span class=mf>1000.</span><span class=p>,</span> <span class=s1>&#39;Transport, lysosomal&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>),</span>
       <span class=p>(</span><span class=s1>&#39;10FTHF6GLUtm&#39;</span><span class=p>,</span> <span class=s1>&#39;6-Glutamyl-10Fthf Transport, Mitochondrial&#39;</span><span class=p>,</span> <span class=mf>0.</span><span class=p>,</span> <span class=mf>1000.</span><span class=p>,</span> <span class=s1>&#39;Transport, mitochondrial&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>),</span>
       <span class=p>(</span><span class=s1>&#39;10FTHF7GLUtl&#39;</span><span class=p>,</span> <span class=s1>&#39;7-Glutamyl-10Fthf Transport, Lysosomal&#39;</span><span class=p>,</span> <span class=mf>0.</span><span class=p>,</span> <span class=mf>1000.</span><span class=p>,</span> <span class=s1>&#39;Transport, lysosomal&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)],</span>
      <span class=n>dtype</span><span class=o>=</span><span class=p>[(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;lb&#39;</span><span class=p>,</span> <span class=s1>&#39;&lt;f8&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;ub&#39;</span><span class=p>,</span> <span class=s1>&#39;&lt;f8&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;subsystem&#39;</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;gpr&#39;</span><span class=p>,</span> <span class=s1>&#39;O&#39;</span><span class=p>)])</span>
</code></pre></div> <p>Basic manipulation, for example, changing the bounds of a reaction, can be done just by modifying the corresponding attribute of the reaction:</p> <div class=highlight><pre><span></span><code><span class=n>rxn</span> <span class=o>=</span> <span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=n>rxn</span><span class=p>[</span><span class=s1>&#39;lb&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<span class=n>rxn</span><span class=p>[</span><span class=s1>&#39;ub&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>10</span>
</code></pre></div> <p>Numpy structured arrays make it easy to modify properties of the network. For example, in order to change the lower bound of all reactions in the network at the same time, you only need to do:</p> <div class=highlight><pre><span></span><code><span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=s1>&#39;lb&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1000</span>
</code></pre></div> <p>Structured arrays also support indexing:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
<span class=c1># List all reactions with a negative lower bound</span>
<span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=s1>&#39;lb&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span>
<span class=c1># Get the indexes of the reactions with a negative lower bound</span>
<span class=n>idxs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>flatnonzero</span><span class=p>(</span><span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=s1>&#39;lb&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</code></pre></div> <h3 id=constraint-based-optimization-problems>Constraint-based optimization problems</h3> <p>MIOM can be seen as a high-level API for creating constraint-based optimization problems by applying successive composable operations that add new constraints to the problem. The basic operation is the <code>steady_state()</code> method, which adds the system of equations <code>S * V = 0</code> to the optimization model, where <code>S</code> is the stoichiometric matrix and <code>V</code> is the vector of fluxes:</p> <div class=highlight><pre><span></span><code><span class=n>model</span> <span class=o>=</span> <span class=p>(</span><span class=n>miom</span>
        <span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;@BiGG/Recon3D.miom&#39;</span><span class=p>)</span>
        <span class=o>.</span><span class=n>steady_state</span><span class=p>())</span>
</code></pre></div> <p>Now the optimization model contains the system of equations for the steady state condition of the fluxes. Now, it can be extended by adding new constraints or changing properties of the model. For example, in order to find the maximum flux of the <code>biomass_reaction</code> (limiting the max production to 10) can be done as follows:</p> <div class=highlight><pre><span></span><code><span class=n>flux</span> <span class=o>=</span> <span class=p>(</span><span class=n>model</span>
        <span class=o>.</span><span class=n>set_rxn_objective</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>)</span>
        <span class=o>.</span><span class=n>set_flux_bounds</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>,</span> <span class=n>max_flux</span><span class=o>=</span><span class=mf>10.0</span><span class=p>)</span>
        <span class=o>.</span><span class=n>solve</span><span class=p>()</span>
        <span class=o>.</span><span class=n>get_fluxes</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>))</span>
</code></pre></div> <p>More complex constraints can be added by using the <code>add_constraint()</code> method. This method accepts an affine expression involving the variables in the model. Here is an example of how to perform FBA again but with a constraint that ensures that the sum through all non-reversible reactions is less than or equal to 10:</p> <p><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>

<span class=c1># Load the Recon3D model from the MIOM repository</span>
<span class=n>network</span> <span class=o>=</span> <span class=n>miom</span><span class=o>.</span><span class=n>load_gem</span><span class=p>(</span><span class=s1>&#39;@BiGG/Recon3D.miom&#39;</span><span class=p>)</span>

<span class=c1># The objective is to maximize the flux through the biomass reaction</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>miom</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>network</span><span class=p>)</span><span class=o>.</span><span class=n>steady_state</span><span class=p>()</span><span class=o>.</span><span class=n>set_rxn_objective</span><span class=p>(</span><span class=s1>&#39;biomass_reaction&#39;</span><span class=p>)</span>

<span class=c1># Find reactions that are not reversible (i.e. can have only positive fluxes)</span>
<span class=n>non_reversible</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>flatnonzero</span><span class=p>(</span><span class=n>network</span><span class=o>.</span><span class=n>R</span><span class=p>[</span><span class=s1>&#39;lb&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span>

<span class=c1># Add the constraint that the sum through all non-reversible reactions is less than or equal to 10</span>
<span class=c1># (note that both PICOS and Python-MIP are symbolic, and expressions involving the variables are allowed)</span>
<span class=n>constraint</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>variables</span><span class=o>.</span><span class=n>fluxvars</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>non_reversible</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>10</span>

<span class=c1># Add to the model and solve </span>
<span class=n>model</span><span class=o>.</span><span class=n>add_constraint</span><span class=p>(</span><span class=n>constraint</span><span class=p>)</span><span class=o>.</span><span class=n>solve</span><span class=p>(</span><span class=n>verbosity</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Starting solution of the Linear programming problem using Dual Simplex

Coin0506I Presolve 2242 (-3594) rows, 6144 (-4456) columns and 33659 (-12128) elements
Clp0014I Perturbing problem by 0.001% of 1.9797539 - largest nonzero change 1.4130091e-06 ( 7.1372964e-05%) - largest zero change 1.412981e-06
Clp0006I 0  Obj 0.0015868455 Primal inf 3303572.7 (1175) Dual inf 1.9797525 (1)
Clp0000I Optimal - objective value 9.062223
Coin0511I After Postsolve, objective 9.062223, infeasibilities - dual 0 (0), primal 0 (0)
Clp0032I Optimal objective 9.062223036 - 1675 iterations time 0.142, Presolve 0.07
</code></pre></div></p> <p>By default, an optimization model is mutable. This means that every time a method that modifies the model is invoked, the original model is modified. For example, the <code>set_flux_bounds()</code> method modifies the bounds of the reactions in the model. If you want to create a copy of the model, you can use the <code>copy()</code> method to create a full copy of the model.</p> <h3 id=mixed-integer-optimization>Mixed Integer Optimization</h3> <p>Many constraint-based metabolic problems consist of selecting a subset of reactions from a generic metabolic network, subject to some biological-based constraints. For example, Sparse FBA consists of selecting the minimum number of active reactions that lead to a desired optimal flux. Context-specific network reconstruction methods such as iMAT, Fastcore, mCADRE, MBA, etc., have also the same purpose: select a subset of reactions from a network based on some experimental data and some objective function. All these problems are instances of a more general problem, known as <strong>best subset selection problem</strong>, which can be modelled using <em>Mixed Integer Optimization (MIO)</em>. However, instances of this problem are usually hard to solve, and some implementations like Fastcore or MBA use different heuristics or relaxations to find sub-optimal solutions in short time. </p> <p>Unfortunately, there are a few problems with these type of approximations. First, we don't know how good is the solution obtained, and in practice many studies that use those methods assume that the solution they obtained is the best one. Second, even though most of these techniques solve the same type of problem, they look very different or hard to understand for practitioners. Third, many of these implementations do not exploit the potential of the modern MIO solvers which are nowadays able to solve very large problems in a short time, and to adjust the desired level of optimality, which gives the user an idea of how good is the solution obtained.</p> <p>MIOM incorporates specific methods to easily model and solve such problems. Just by calling the method <code>subset_selection()</code>, which takes as input a weight for all reactions or a list of weights for each reaction, it transforms the current problem into a <em>best subset selection</em> problem, in which the objective function is the sum of the weights of the reactions in the solution (where positive weighted reactions contribute to the objective function if they are selected, and negative weighted reactions contribute to the objective function if they are not selected).</p> <p>This simple method makes it possible to model a wide variety of complex constraint-based optimization problems. See for example how easy it is to implement the exact version of the weighted Fastcore with MIOM:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>miom</span>
<span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>

<span class=c1># Use the flux-consistent subnetwork (fcm) of the Human1 GEM model</span>
<span class=c1># NOTE: Fastcore requires that reactions in the core are flux consistent,</span>
<span class=c1># otherwise the problem would be infeasible. </span>
<span class=n>m</span> <span class=o>=</span> <span class=n>miom</span><span class=o>.</span><span class=n>load_gem</span><span class=p>(</span><span class=s1>&#39;@homo_sapiens_human1_fcm.miom&#39;</span><span class=p>)</span>
<span class=c1># Select reactions from the cholesterol metabolism as the core reactions to keep</span>
<span class=n>core_rxn</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>find_reactions_from_pathway</span><span class=p>(</span><span class=s2>&quot;Cholesterol metabolism&quot;</span><span class=p>)</span>
<span class=c1># Assign a negative weight for reactions not in the core</span>
<span class=n>weights</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>num_reactions</span><span class=p>)</span>
<span class=n>weights</span><span class=p>[</span><span class=n>core_rxn</span> <span class=o>==</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>

<span class=n>fmc</span> <span class=o>=</span> <span class=p>(</span><span class=n>miom</span>
        <span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
        <span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>opt_tol</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> <span class=n>verbosity</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=o>.</span><span class=n>steady_state</span><span class=p>()</span>
        <span class=o>.</span><span class=n>subset_selection</span><span class=p>(</span><span class=n>weights</span><span class=p>)</span>
        <span class=o>.</span><span class=n>keep</span><span class=p>(</span><span class=n>core_rxn</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
        <span class=o>.</span><span class=n>solve</span><span class=p>()</span>
        <span class=o>.</span><span class=n>select_subnetwork</span><span class=p>(</span>
            <span class=n>mode</span><span class=o>=</span><span class=n>miom</span><span class=o>.</span><span class=n>ExtractionMode</span><span class=o>.</span><span class=n>ABSOLUTE_FLUX_VALUE</span><span class=p>,</span>
            <span class=n>comparator</span><span class=o>=</span><span class=n>miom</span><span class=o>.</span><span class=n>Comparator</span><span class=o>.</span><span class=n>GREATER_OR_EQUAL</span><span class=p>,</span>
            <span class=n>value</span><span class=o>=</span><span class=mf>1e-8</span>
        <span class=p>)</span>
        <span class=o>.</span><span class=n>network</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>fmc</span><span class=o>.</span><span class=n>num_reactions</span><span class=p>)</span>
</code></pre></div> <h2 id=advantages>Advantages</h2> <ul> <li><strong>It's easy to use:</strong> MIOM uses the <a href=https://picos-api.gitlab.io/picos/ >PICOS</a> and the <a href=https://www.python-mip.com/ >Python-MIP</a> libraries, which means you can use any solver supported by those libraries.</li> <li><strong>It's easy to extend:</strong> MIOM is written in pure python, so you can easily extend it to solve more complex optimization problems.</li> <li><strong>It makes the problem explicit:</strong> MIOM uses a declarative way to express the problem, so you can easily read and understand what you are solving and differences between algorithms.</li> <li><strong>It's fast:</strong> MIOM leverages the power of MIO solvers to solve complex optimization problems. You can control the quality and speed of the solutions for your problem and get better solutions that the approximations (LP) of the original problem available in other constraint-based modeling libraries.</li> <li><strong>It's lightweight:</strong> The library has a small number of dependencies, so it's easy to install and distribute also in HPC environments.</li> <li><strong>It includes a compressed GEM format</strong>: MIOM can load and save the minimal information of the metabolic networks required for performing simulations into a compressed file compatible with numpy. The small size of the files allows you to quickly run online experiments so other people can reproduce your results. It also supports SBML and matlab formats if <code>cobratoolbox</code> is installed.</li> <li><strong>It's open-source:</strong> MIOM is open-source and free to use. You can contribute to the development of MIOM by forking the repository and sending pull requests.</li> </ul> <h2 id=documentation>Documentation</h2> <p>The documentation of the library can be found at <a href=https://metexplore.github.io/miom/ >https://metexplore.github.io/miom/</a></p> <h2 id=how-to-cite>How to cite</h2> <p>Manuscript in progress</p> <h2 id=license>License</h2> <p>GNU General Public License v3.0</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=examples/fastcore/ class="md-footer__link md-footer__link--next" aria-label="Next: Exact Fastcore (MIP)" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Exact Fastcore (MIP) </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2021 INRAE Toxalim </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.709b4209.min.js", "version": {"provider": "mike"}}</script> <script src=assets/javascripts/bundle.febc23d1.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js data-cfasync=false></script> <script>
		window.cookieconsent.initialise({
			"palette": {
			"popup": {
				"background": "#edeff5",
				"text": "#838391"
			},
			"button": {
				"background": "#4b81e8"
			}
			}
		});
	</script> </body> </html>